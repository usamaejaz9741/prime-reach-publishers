<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Header Scroll Threshold Test - BUGGY VERSION</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            height: 3000px; /* Make page scrollable */
        }
        
        .main-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: #333;
            color: white;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .main-header.fixed-header {
            background: #cc0000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #cc0000;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            display: none;
        }
        
        .test-container {
            margin-top: 100px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        
        .test-result.pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .test-result.fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .test-result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        #test-output {
            margin-top: 20px;
        }
        
        .scroll-indicator {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .warning-banner {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <header class="main-header">
        <h1>Header Scroll Threshold Test - BUGGY VERSION</h1>
    </header>
    
    <button class="scroll-top">‚Üë Top</button>
    
    <div class="scroll-indicator" id="scrollIndicator">
        Scroll: 0px
    </div>
    
    <div class="test-container">
        <div class="warning-banner">
            <strong>‚ö†Ô∏è WARNING:</strong> This test uses the BUGGY version of the code with inconsistent thresholds (250px on load, 100px on scroll).
            This demonstrates the bug that was fixed.
        </div>
        
        <h2>Automated Test Suite - Demonstrating the Bug</h2>
        <p>This test demonstrates the inconsistent behavior with the original buggy code.</p>
        
        <button onclick="runTests()" style="padding: 10px 20px; background: #cc0000; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
            Run Tests (Expect Failures)
        </button>
        
        <div id="test-output"></div>
    </div>

    <!-- Load jQuery -->
    <script src="assets/js/jquery-3.6.0.min.js"></script>
    
    <!-- Inline buggy version of the script -->
    <script>
        (function ($) {
            "use strict";

            $(document).ready(function () {
                // ## Header Style and Scroll to Top - BUGGY VERSION with 250px threshold
                function headerStyle() {
                    if ($(".main-header").length) {
                        var windowpos = $(window).scrollTop();
                        var siteHeader = $(".main-header");
                        var scrollLink = $(".scroll-top");
                        if (windowpos >= 250) {  // BUG: Different threshold here (250)
                            siteHeader.addClass("fixed-header");
                            scrollLink.fadeIn(300);
                        } else {
                            siteHeader.removeClass("fixed-header");
                            scrollLink.fadeOut(300);
                        }
                    }
                }
                headerStyle();
            });

            $(window).on("scroll", function () {
                // Header Style and Scroll to Top - BUGGY VERSION with 100px threshold
                function headerStyle() {
                    if ($(".main-header").length) {
                        var windowpos = $(window).scrollTop();
                        var siteHeader = $(".main-header");
                        var scrollLink = $(".scroll-top");
                        if (windowpos >= 100) {  // BUG: Different threshold here (100)
                            siteHeader.addClass("fixed-header");
                            scrollLink.fadeIn(300);
                        } else {
                            siteHeader.removeClass("fixed-header");
                            scrollLink.fadeOut(300);
                        }
                    }
                }

                headerStyle();
            });
        })(jQuery);
    </script>
    
    <script>
        // Update scroll indicator
        $(window).on('scroll', function() {
            $('#scrollIndicator').text('Scroll: ' + $(window).scrollTop() + 'px');
        });
        
        // Test Suite - This should FAIL with buggy code
        function runTests() {
            const output = $('#test-output');
            output.html('<h3>Running Tests...</h3>');
            
            const results = [];
            
            // Test 1: Verify inconsistent behavior at 150px
            window.scrollTo(0, 150);
            setTimeout(() => {
                const hasFixedClass = $('.main-header').hasClass('fixed-header');
                results.push({
                    name: 'Test 1: Consistent behavior at 150px',
                    pass: hasFixedClass, // With buggy code, this depends on whether we scrolled or loaded
                    message: hasFixedClass 
                        ? 'Header has fixed-header class at 150px (scroll threshold 100px is active)' 
                        : 'Header does NOT have fixed-header class at 150px (load threshold 250px is active) - INCONSISTENT!'
                });
                
                // Test 2: Header SHOULD have fixed-header class at 100px
                window.scrollTo(0, 100);
                setTimeout(() => {
                    const hasFixedClass = $('.main-header').hasClass('fixed-header');
                    results.push({
                        name: 'Test 2: Header fixed at 100px (scroll threshold)',
                        pass: hasFixedClass,
                        message: hasFixedClass 
                            ? 'Header correctly has fixed-header class at 100px during scroll' 
                            : 'FAIL: Header does not have fixed-header class at 100px'
                    });
                    
                    // Test 3: Demonstrate inconsistency - scroll to 200px
                    window.scrollTo(0, 200);
                    setTimeout(() => {
                        const hasFixedClass = $('.main-header').hasClass('fixed-header');
                        results.push({
                            name: 'Test 3: Header fixed at 200px',
                            pass: hasFixedClass,
                            message: hasFixedClass 
                                ? 'Header has fixed-header class at 200px' 
                                : 'FAIL: Header does not have fixed-header class at 200px'
                        });
                        
                        // Test 4: The critical test - at 250px boundary
                        window.scrollTo(0, 250);
                        setTimeout(() => {
                            const hasFixedClass = $('.main-header').hasClass('fixed-header');
                            results.push({
                                name: 'Test 4: Header fixed at 250px (original load threshold)',
                                pass: hasFixedClass,
                                message: hasFixedClass 
                                    ? 'Header has fixed-header class at 250px' 
                                    : 'FAIL: Header does not have fixed-header class at 250px'
                            });
                            
                            // Display results
                            displayResults(results);
                        }, 100);
                    }, 100);
                }, 100);
            }, 100);
        }
        
        function displayResults(results) {
            let html = '<h3>Test Results</h3>';
            html += '<div class="test-result info">Note: With the buggy code, behavior is inconsistent. The scroll event uses 100px threshold while the initial load uses 250px threshold.</div>';
            
            let passCount = 0;
            let failCount = 0;
            
            results.forEach(result => {
                if (result.pass) {
                    passCount++;
                    html += `<div class="test-result pass">‚úì ${result.name}<br><small>${result.message}</small></div>`;
                } else {
                    failCount++;
                    html += `<div class="test-result fail">‚úó ${result.name}<br><small>${result.message}</small></div>`;
                }
            });
            
            const totalTests = results.length;
            
            html += `<div class="test-result info" style="margin-top: 20px; font-weight: bold;">
                Summary: ${passCount}/${totalTests} tests passed
                <br>‚ö†Ô∏è This demonstrates the bug: inconsistent thresholds (250px on load, 100px on scroll)
                <br>üìù The fixed version should use a consistent 100px threshold everywhere.
            </div>`;
            
            $('#test-output').html(html);
            
            // Scroll back to top after tests
            setTimeout(() => {
                window.scrollTo(0, 0);
            }, 2000);
        }
    </script>
</body>
</html>



